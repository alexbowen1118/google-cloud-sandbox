steps:
# Run docker-compose.yml
  - name: 'docker/compose'
    id: 'compose-up'
    args: [ '-f', 'src/docker-compose.yml', 'up', '-d' ]

# Build the new docker image.
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'us-west2-docker.pkg.dev/ringed-marker-378116/google-cloud-sandbox-repo/google-cloud-sandbox-image:latest', '.']

# Push the new image to the Artifact Registry.
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', '-t', 'us-west2-docker.pkg.dev/ringed-marker-378116/google-cloud-sandbox-repo/google-cloud-sandbox-image:latest', '.']

images: ['us-west2-docker.pkg.dev/ringed-marker-378116/google-cloud-sandbox-repo/google-cloud-sandbox-image:latest']

options:
  logging: CLOUD_LOGGING_ONLY