<?php$dbTable="park_use";$file="display.php";$fileMenu="menu.php";include("../../include/connectATTEND.inc");// database connection parameters//echo "<pre>";print_r($_REQUEST);echo "</pre>";//exit;extract($_REQUEST);// ******** Update Record ***********if($submit=="Update"){//echo "<pre>";print_r($_REQUEST);echo "</pre>"; //exit;// FIELD NAMES are stored in $fieldArray$sql = "SHOW COLUMNS FROM $dbTable";//echo "$sql";$result = mysql_query($sql) or die ("Couldn't execute query 1. $sql");while ($row=mysql_fetch_assoc($result)){extract($row);$fieldName[]=$row[Field];}$updateFields="SET ";for($i=0;$i<count($fieldName);$i++){$tf=str_replace(".","_",$fieldName[$i]);$eField=${$tf};if($fieldName[$i]!="id"){if($i==0){$updateFields.="`".$fieldName[$i]."`='".$eField."'";}else{$updateFields.=",`".$fieldName[$i]."`='".$eField."'";}}// end if fieldName}// end for//echo "$updateFields";exit;$query="update assets $updateFields where id='$editID'";//echo "$query";exit;$result = mysql_query($query) or die ("Couldn't execute query 1. $query");header("Location: assets.php?asset_category=$asset_category&parkcode=$parkcode");exit;}include("$fileMenu");// necessary to place this AFTER update script// ******** Show Record to Edit ***********if($e==1){// FIELD NAMES are stored in $fieldArray$fieldName=array("center", "project_parkcode", "proj_num", "projname", "vendorname", "purchase_description", "invoice_amt", "invoice_num", "pcard_vendor", "pcard_name");echo "<table border='1' cellpadding='3' align='center'>";echo "<tr>";for($i=0;$i<count($fieldName);$i++){$fn=str_replace('_','<br>',$fieldName[$i]);echo "<th>$fn</th>";}echo "</tr>";$sql = " SELECT center, project_parkcode, proj_num, projname, vendorname, purch_descr_input AS purchase_description, amount AS 'invoice_amt', invoice AS 'invoice_num', pcard_vendor, pcard_name FROM partf_payments WHERE 1 AND center_stateparkyn = 'n' AND fund != '1280' AND center_dist = '$center_dist' AND center='$center' ORDER BY `project_parkcode` ASC "; echo "<br>$sql<br>";    $result = mysql_query($sql) or die ("Couldn't execute query 3. $sql");while($row = mysql_fetch_array($result)){extract($row);$total=$total+$invoice_amt;$invoice_amt=number_format($invoice_amt,2);echo "<tr><td>$center</td><td>$project_parkcode</td><td>$proj_num</td><td>$projname</td><td>$vendorname</td><td>$purchase_description</td><td align='right'>$invoice_amt</td><td>$invoice_num</td><td>$pcard_vendor</td><td>$pcard_name</td></tr>";}// end while$total=number_format($total,2);echo "Total: $total</table>";exit;}// ******** Show Results ***********// FIELD NAMES are stored in $fieldArray// FIELD TYPES and SIZES are stored in $fieldType$fieldName=array("center", "center_desc", "center_cyinitfund", "centerman", "center_section", "center_dist", "spent");//print_r($fieldName);if($center_dist!=""){echo "<table border='1' cellpadding='3' align='center'><tr>";for($i=0;$i<count($fieldName);$i++){echo "<th>$fieldName[$i]</th>";}echo "</tr>";$query="SELECT center, center_desc, center_cyinitfund, centerman, center_section, center_dist, sum( amount ) AS 'spent' FROM partf_payments WHERE 1 AND center_stateparkyn = 'n' AND fund != '1280' AND center_dist = '$center_dist' GROUP BY center"; echo "$query";    $result = @MYSQL_QUERY($query,$connection);//echo "<pre>";print_r($row);echo "</pre>";// extract($row); while($row = mysql_fetch_array($result)){echo "<tr>";for($i=0;$i<count($fieldName);$i++){$t=$row[$i];$vk=$fieldName[$i];if($vk=="center"){$center=$t;}if($fieldName[$i]=="spent"){$total=$total+$t;}if($vk=="spent"){$tf="<td><a href='assets.php?e=1&id=$t'>$t</a></td>";}if($vk=="spent"){$tn=number_format($t,2);$tf="<td align='right'><a href='prtf_pay_center.php?center=$center&center_dist=$center_dist&e=1'>$tn</a></td>";}else{$tf="<td>$t</td>";}echo "$tf";}echo "</tr>";}// end while$total=number_format($total,2);echo "<tr><td colspan='11' align='right'><b>$total</b></td></tr></table>";}// end ifecho "</div></body></html>";?>